<!--<%include:/includes/inc.main.header.html%>-->
<!--<%include:/includes/inc.layout.leftpanel.header.html%>-->
<!--<%include:/includes/inc.links.roles.html%>-->
<!--<%include:/includes/inc.layout.leftpanel.middle.html%>-->

<script>
    document.getElementById("apptitle").innerHTML = "Roles &#9658; Create New Role";
    document.getElementById("mainview-role-create-link").style.color = "white";

    function csrfReady() {
    }
    function ajaxCreateRole() {

        var payloadData = {
            roleName: $("#roleName").val().toUpperCase(),
            roleDescription: $("#description").val()
        };

        $.ajax({
            url: '/japi_exec?method=roleAdd',
            headers: { "CSRFToken": csrfToken },
            data: { payload: JSON.stringify(payloadData) },
            type: 'POST',
            success: function (response) {

                if (response["retCode"] == false) {
                    showToastError("Role creation failed (" + response["retMsg"] + ").");
                }
                else {
                    showToastSuccess("Role was created!");
                    window.location = "/role-edit?" + window.btoa($("#roleName").val().toUpperCase());
                }
            },
            error: commonFunctionError
        });
    }
    function checkRoleName() {
        var regex = new RegExp("^[a-zA-Z0-9_-]+$");
        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
        if (!regex.test(key)) {
            event.preventDefault();
            return false;
        }
        return true;
    }
</script>
<table width=100% style=" border-spacing: 10px;   border-collapse: separate;">
    <tr>
        <td colspan="2" align="right"> <button type="button" class="btn btn-success"
                onclick="javascript:ajaxCreateRole()">Create Role</button> </td>
    </tr>

    <tr>
        <td colspan="2" align="">
            <h5>Role Info</h5>
            <hr>
        </td>
    </tr>
    <tr>
        <td align="right">Role Name: </td>
        <td><input type="text" name="roleName" id="roleName" class="form-control" placeholder="Role Name"
                style="text-transform: uppercase" onkeypress="javascript:checkRoleName()"></td>
    </tr>
    <tr>
        <td align="right">Description: </td>
        <td><input id="description" class="form-control" placeholder="Description"></td>
    </tr>
</table>

<!--<%include:/includes/inc.layout.leftpanel.footer.html%>-->
<!--<%include:/includes/inc.main.footer.html%>-->
