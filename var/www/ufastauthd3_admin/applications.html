<!--<%include:/includes/inc.main.header.html%>-->
<!--<%include:/includes/inc.layout.leftpanel.header.html%>-->
<!--<%include:/includes/applications/inc.links.applications.html%>-->
<!--<%include:/includes/inc.layout.leftpanel.middle.html%>-->

<script>
  document.getElementById("apptitle").innerHTML = "Applications &#9658; Applications Directory";
  document.getElementById("mainview-application-directory-link").style.color = "white";
</script>

<div class="container-fluid" style="width: 95%;">
  <div class="d-flex justify-content-end mb-3">
    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalCreateApplication"
      onclick="createApplicationClearParameters()">
      Add Application
    </button>
  </div>
  <hr>

  <table id="applicationsTable" class="display">
    <thead>
      <tr>
        <th scope="col">Application Name</th>
        <th scope="col">Description</th>
        <th scope="col">Owner</th>
        <th scope="col" style="text-align: right;">Controls&nbsp;</th>
      </tr>
    </thead>
    <tbody>

    </tbody>
  </table>
</div>

<script>
  function generateRandomKey(id) {
    var proposedKey = genNewKey();

    document.getElementById(id).value = proposedKey;
  }

  new DataTable('#applicationsTable', {
    ajax: {
      "url": "/api/v1/searchApplications",
      "type": 'GET',
      "data": function (d) {
        return JSON.stringify(d);
      }
    },
    processing: true,
    serverSide: true,
    columns: [
      {
        data: "appName",
        title: "Application Name",
        render: function (data, type, row) {
          return '<i class="fas fa-window-maximize"></i> &nbsp;&nbsp;' + data;
        }
      },
      {
        data: "appDescription",
        title: "Description",
        searchable: false
      },
      {
        data: "appCreator",
        title: "Owner",
        searchable: false
      },
      {
        data: null,
        orderable: false,
        searchable: false,
        render: function (data, type, row) {
          let b64AppName = window.btoa(row.appName);
          return `<div class="d-flex flex-wrap gap-1 justify-content-end">
                        <button type="button" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#modalEditApplication" onclick="loadAndEditApplication('${b64AppName}')">
                          Edit
                        </button>
                      </div>`;
        }
      }
    ]
  });
</script>

<!--<%include:/includes/applications/inc.modal.newapplication.html%>-->
<!--<%include:/includes/applications/inc.modal.editapplication.html%>-->

<!--<%include:/includes/applications/roles/inc.modal.newrole.html%>-->
<!--<%include:/includes/applications/roles/inc.modal.editrole.html%>-->

<!--<%include:/includes/applications/activities/inc.modal.newactivity.html%>-->
<!--<%include:/includes/applications/activities/inc.modal.editactivity.html%>-->

<!--<%include:/includes/applications/scopes/inc.modal.newscope.html%>-->


<!--<%include:/includes/inc.layout.leftpanel.footer.html%>-->
<!--<%include:/includes/inc.main.footer.html%>-->