; Sample Configuration File for RESTful Service

; Logs
Logs {
    Debug "true"
    ShowDate "true"
    ShowColors "true"
}

; Auth
Auth {
    Driver "SQLite3"
    File "/home/coding/Devel/ROOT/var/lib/ufastauthd2/main.db"
}

; Web Login Service (Only WebAPI Based Login Service)
WebLoginService
{
    ; General Settings
    ListenPort 8443            ; Port to listen on
    ListenAddr "0.0.0.0"       ; Address to listen on (all interfaces)
    UseIPv6 false                 ; Use IPv6 instead of IPv4

    ; TLS Configuration (if UseTLS is true)
    UseTLS true                ; Enable or disable TLS
    TLS
    {
        CertFile "tls/snakeoil.crt"   ; Path to the public certificate file in PEM format
        KeyFile  "tls/snakeoil.key"   ; Path to the private key file in PEM format
    }

    ; Resource and Document Root Settings
    ResourcesPath "/home/coding/Devel/ROOT/var/www/ufastauthd2_login"  ; Default path for web resources

    ; API Configuration
    API
    {
        Origins "https://login.localhost:8443"            ; Permitted origins for API requests (comma-separated)
    }

    ; Login Configuration
    Login
    {
        ;Origins "https://login.localhost:8443"       ; Permitted origins for login requests (comma-separated)
        ;RedirectURL "/login"   ; URL to redirect after successful login
    }

    ; JWT Configuration
    JWT {
        Algorithm "HS256"
        HMACSecret "jwt/hmac_secret.key"
        PublicKeyFile ""
        PrivateKeyFile ""
    }

    ; Thread Pool Configuration
    Threads
    {
        UseThreadPool false          ; Use a thread pool instead of multi-threading
        PoolSize 20                  ; Number of threads in the pool (if using ThreadPool)
        MaxThreads 500               ; Maximum number of concurrent threads (if not using ThreadPool)
    }

    ; Time passed until the authentication intermediary token is timed out
    AuthenticationTimeout "150"

    Registration {
        AllowSelfRegistration false
        AutoConfirm false
    }

    ; Logging Settings (TODO)
    ;LogFilePath "/var/log/restful_service.log"  ; Path to the log file
}


; Web Admin Service (Admin Website for the IAM)
WebAdminService
{
    ; General Settings
    ListenPort 9443            ; Port to listen on
    ListenAddr "0.0.0.0"       ; Address to listen on (all interfaces)
    UseIPv6 false                 ; Use IPv6 instead of IPv4

    ; TLS Configuration (if UseTLS is true)
    UseTLS true                ; Enable or disable TLS
    TLS
    {
        CertFile "tls/snakeoil.crt"   ; Path to the public certificate file in PEM format
        KeyFile  "tls/snakeoil.key"   ; Path to the private key file in PEM format
    }

    ; Resource and Document Root Settings
    ResourcesPath "/home/coding/Devel/ROOT/var/www/ufastauthd2_admin"  ; Default path for web resources

    ; API Configuration
    API
    {
        ;Origins ""            ; Permitted origins for API requests (comma-separated)
    }

    ; Login Configuration
    Login
    {
        Origins "https://login.localhost:8443"       ; Permitted origins for login requests (comma-separated)
        RedirectURL "https://login.localhost:8443/?app=IAM&redirectURI=&loggedIn=false"   ; URL to redirect after successful login
    }

    ; Thread Pool Configuration
    Threads
    {
        UseThreadPool false          ; Use a thread pool instead of multi-threading
        PoolSize 20                  ; Number of threads in the pool (if using ThreadPool)
        MaxThreads 10000             ; Maximum number of concurrent threads (if not using ThreadPool)
    }

    Proxies
    {
        "/auth" {
            ; ApiProxy Configuration
            UseTLS true   ; Use TLS
            CheckTLSPeer false   ; Check TLS peer 
            UsePrivateCA false   ; Do not use private CA
            RemoteHost "127.0.0.1"   ; Remote host
            RemotePort 8443   ; Remote port

            ExtraHeaders ; Custom header values
            {
                "x-api-key" "%APIKEY%"
            }

            PrivateCAPath "/path/to/ca.pem"   ; Path to private CA (if UsePrivateCA were true)
        }
    }

    ; Logging Settings (TODO)
    ;LogFilePath "/var/log/restful_service.log"  ; Path to the log file
}
